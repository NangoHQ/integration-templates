[
    {
        "providerConfigKey": "sharepoint-online",
        "syncs": [
            {
                "name": "user-files",
                "type": "sync",
                "description": "Fetch all files from the user's drive and sync the metadata for each file.",
                "sync_type": "full",
                "usedModels": ["UserFileMetadata"],
                "runs": "every hour",
                "version": "",
                "track_deletes": false,
                "auto_start": true,
                "input": null,
                "output": ["UserFileMetadata"],
                "scopes": ["Sites.Read.All", "Sites.Selected", "MyFiles.Read", "Files.Read.All", "Files.Read.Selected", "offline_access"],
                "endpoints": [
                    {
                        "method": "GET",
                        "path": "/user-files"
                    }
                ],
                "webhookSubscriptions": []
            },
            {
                "name": "user-files-selection",
                "type": "sync",
                "description": "Fetch all selected files from a user's drive",
                "sync_type": "full",
                "usedModels": ["SelectedUserFileMetadata", "SharepointMetadata", "PickedFile"],
                "runs": "every hour",
                "version": "",
                "track_deletes": false,
                "auto_start": false,
                "input": "SharepointMetadata",
                "output": ["SelectedUserFileMetadata"],
                "scopes": ["Sites.Read.All", "Sites.Selected", "MyFiles.Read", "Files.Read.All", "Files.Read.Selected", "offline_access"],
                "endpoints": [
                    {
                        "method": "GET",
                        "path": "/user-files/selected"
                    }
                ],
                "webhookSubscriptions": []
            },
            {
                "name": "shared-sites-selection",
                "type": "sync",
                "description": "This sync will be used to sync file metadata from SharePoint site based on the ones the user has picked.",
                "sync_type": "incremental",
                "usedModels": ["FileMetadata", "SharepointMetadata", "PickedFile"],
                "runs": "every 1 hour",
                "version": "2.0.1",
                "track_deletes": false,
                "auto_start": false,
                "input": "SharepointMetadata",
                "output": ["FileMetadata"],
                "scopes": ["Sites.Read.All", "Sites.Selected", "MyFiles.Read", "Files.Read.All", "Files.Read.Selected", "offline_access"],
                "endpoints": [
                    {
                        "method": "GET",
                        "path": "/shared-files/selected"
                    }
                ],
                "webhookSubscriptions": []
            }
        ],
        "actions": [
            {
                "name": "list-shared-sites",
                "type": "action",
                "description": "This action will be used to display a list of sites to the end-user, who will pick the ones he wants to sync.\nThe connection metadata should be set based on the file selection.",
                "version": "2.0.1",
                "scopes": ["Sites.Read.All", "Sites.Selected", "offline_access"],
                "input": null,
                "output": ["SharepointSites"],
                "usedModels": ["SharepointSites", "Site"],
                "endpoint": {
                    "method": "GET",
                    "path": "/list-sites"
                }
            },
            {
                "name": "fetch-file",
                "type": "action",
                "description": "This action will be used to fetch the latest file download_url which can be used to download the actual file.",
                "version": "1.0.1",
                "scopes": ["MyFiles.Read", "offline_access"],
                "input": "FetchFileInput",
                "output": ["FetchFile"],
                "usedModels": ["FetchFile", "FetchFileInput"],
                "endpoint": {
                    "method": "GET",
                    "path": "/fetch-file"
                }
            }
        ],
        "onEventScripts": {
            "post-connection-creation": [],
            "pre-connection-deletion": []
        }
    }
]
